"use strict";function _typeof(a){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=void 0;var _react=_interopRequireWildcard(require("react")),_propTypes=_interopRequireDefault(require("prop-types")),_simplebarReact=_interopRequireDefault(require("simplebar-react"));require("simplebar/dist/simplebar.min.css");var _StyledList=_interopRequireDefault(require("../../assets/styles/StyledList")),_styled=_interopRequireDefault(require("./styled")),_useSearchAction3=_interopRequireDefault(require("../../assets/hooks/useSearchAction")),_sortData=_interopRequireDefault(require("../../utils/sortData")),_ToolbarButton=_interopRequireDefault(require("./ToolbarButton")),_Sort=_interopRequireDefault(require("../Sort")),_RowCell=_interopRequireDefault(require("../RowCell")),_Refresh=_interopRequireDefault(require("../Refresh")),_Title=_interopRequireDefault(require("../Title")),_Checkbox=_interopRequireDefault(require("../Checkbox"));function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function _getRequireWildcardCache(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(_getRequireWildcardCache=function(a){return a?c:b})(a)}function _interopRequireWildcard(a,b){if(!b&&a&&a.__esModule)return a;if(null===a||"object"!==_typeof(a)&&"function"!=typeof a)return{default:a};var c=_getRequireWildcardCache(b);if(c&&c.has(a))return c.get(a);var d={},e=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in a)if("default"!=f&&Object.prototype.hasOwnProperty.call(a,f)){var g=e?Object.getOwnPropertyDescriptor(a,f):null;g&&(g.get||g.set)?Object.defineProperty(d,f,g):d[f]=a[f]}return d["default"]=a,c&&c.set(a,d),d}function _toConsumableArray(a){return _arrayWithoutHoles(a)||_iterableToArray(a)||_unsupportedIterableToArray(a)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(a){if("undefined"!=typeof Symbol&&null!=a[Symbol.iterator]||null!=a["@@iterator"])return Array.from(a)}function _arrayWithoutHoles(a){if(Array.isArray(a))return _arrayLikeToArray(a)}function _extends(){return _extends=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a},_extends.apply(this,arguments)}function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(Object(b),!0).forEach(function(c){_defineProperty(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(Object(b)).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function _slicedToArray(a,b){return _arrayWithHoles(a)||_iterableToArrayLimit(a,b)||_unsupportedIterableToArray(a,b)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(a,b){if(a){if("string"==typeof a)return _arrayLikeToArray(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?_arrayLikeToArray(a,b):void 0}}function _arrayLikeToArray(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}function _iterableToArrayLimit(a,b){var c=null==a?null:"undefined"!=typeof Symbol&&a[Symbol.iterator]||a["@@iterator"];if(null!=c){var d,e,f=[],g=!0,h=!1;try{for(c=c.call(a);!(g=(d=c.next()).done)&&(f.push(d.value),!(b&&f.length===b));g=!0);}catch(a){h=!0,e=a}finally{try{g||null==c["return"]||c["return"]()}finally{if(h)throw e}}return f}}function _arrayWithHoles(a){if(Array.isArray(a))return a}var SearchSvg=function(a){return/*#__PURE__*/_react["default"].createElement("svg",a,/*#__PURE__*/_react["default"].createElement("path",{d:"M15.853 16.56A9.458 9.458 0 0 1 9.5 19C4.257 19 0 14.743 0 9.5S4.257 0 9.5 0 19 4.257 19 9.5c0 2.442-.923 4.67-2.44 6.353l7.44 7.44-.707.707-7.44-7.44zM9.5 1C14.191 1 18 4.809 18 9.5S14.191 18 9.5 18 1 14.191 1 9.5 4.809 1 9.5 1z"}))};SearchSvg.defaultProps={width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg",fillRule:"evenodd",clipRule:"evenodd"};var EraserSvg=function(a){return/*#__PURE__*/_react["default"].createElement("svg",a,/*#__PURE__*/_react["default"].createElement("path",{d:"M5.662 23 .293 17.635a.996.996 0 0 1 0-1.414L15.222 1.293a1.001 1.001 0 0 1 1.414 0l7.071 7.073a.994.994 0 0 1 .293.708.995.995 0 0 1-.293.707L12.491 21h5.514v2H5.662zm3.657-2-5.486-5.486-1.419 1.414L6.49 21h2.829zm.456-11.429-4.528 4.528 5.658 5.659 4.527-4.53-5.657-5.657z"}))};EraserSvg.defaultProps={width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg",fillRule:"evenodd",clipRule:"evenodd"};var EzReactTable=function(a){var b=a.data,c=a.cols,d=a.rowHeight,e=a.tableHeight,f=a.update,g=a.infiniteLoad,h=a.defaultSort,i=a.accentColor,j=a.darkMode,k=a.title,l=a.toolbar,m=a.selectable,n=a.uid,o=(0,_useSearchAction3["default"])(c,b),p=_slicedToArray(o,2),q=p[0],r=p[1],s=(0,_react.useState)(h?[h,"descend"]:null),t=_slicedToArray(s,2),u=t[0],v=t[1],w=(0,_react.useState)(!1),x=_slicedToArray(w,2),y=x[0],z=x[1];(0,_react.useEffect)(function(){z(!1)},[b]);var A=(0,_react.useMemo)(function(){return(0,_sortData["default"])(r,u,v)},[u,r]),B=(0,_react.useState)([]),C=_slicedToArray(B,2),D=C[0],E=C[1],F=(0,_react.useState)(!1),G=_slicedToArray(F,2),H=G[0],I=G[1],J=function(a){a=a||[];var b=function(a,b){var c=null===a||void 0===a?void 0:a.button,d=null===a||void 0===a?void 0:a.props,e=null===a||void 0===a?void 0:a.selected;if(e){var f;if(!D.length)return null;null!==(f=d)&&void 0!==f&&f.onClick&&(d=_objectSpread(_objectSpread({},d),{},{onClick:function onClick(){a.props.onClick(D),L()}}))}return/*#__PURE__*/_react["default"].createElement(_ToolbarButton["default"],_extends({key:b},d),/*#__PURE__*/_react["default"].createElement(c,null))};return a.map(b)},K=function(a){E([].concat(_toConsumableArray(D),[a]))},L=function(){I(!1),E([])},M=function(a){E(D.filter(function(b){return b[n]!==a[n]}))},N=(0,_react.useMemo)(function(){return J(l)},[D]);return/*#__PURE__*/_react["default"].createElement(_styled["default"],_objectSpread(_objectSpread({},{data:b,cols:c,rowHeight:d,tableHeight:e,update:f,infiniteLoad:g,defaultSort:h,accentColor:i,darkMode:j,title:k,selectable:m,uid:n}),{},{tableWidth:c.reduce(function(b,a){return b+a.width},0)+50}),/*#__PURE__*/_react["default"].createElement("div",{className:"ezr-table"},/*#__PURE__*/_react["default"].createElement(_Title["default"],null,k),/*#__PURE__*/_react["default"].createElement("div",{className:"ezr-header"},/*#__PURE__*/_react["default"].createElement("div",{className:"ezr-header-left"},/*#__PURE__*/_react["default"].createElement("div",{className:"ezr-search"},/*#__PURE__*/_react["default"].createElement("input",_extends({},q,{className:"ezr-search-input",type:"text"})),/*#__PURE__*/_react["default"].createElement("button",{onClick:function onClick(){q.value.length&&q.onChange({target:{value:""}})}},q.value.length?/*#__PURE__*/_react["default"].createElement(EraserSvg,{className:"ezr-search-icon",style:{transform:"scale(70%)"}}):/*#__PURE__*/_react["default"].createElement(SearchSvg,{className:"ezr-search-icon",style:{transform:"scale(70%)"}})))),/*#__PURE__*/_react["default"].createElement("div",{className:"ezr-toolbar"},N,f&&/*#__PURE__*/_react["default"].createElement(_Refresh["default"],{data:b,update:f}))),/*#__PURE__*/_react["default"].createElement("div",{className:"ezr-body"},/*#__PURE__*/_react["default"].createElement("div",{className:"ezr-col-header"},m&&/*#__PURE__*/_react["default"].createElement(_Checkbox["default"],{checked:H,onChecked:function addAllToSelection(){I(!0),E(_toConsumableArray(A))},onUnchecked:L,accentColor:i}),c.map(function(a,b){return/*#__PURE__*/_react["default"].createElement("div",{key:b,style:{height:"".concat(d,"px"),width:"".concat(a.width,"px")},className:"ezr-col-header-cell",onClick:function onClick(){u&&u[0]===a.key?v([a.key,"descend"===u[1]?"ascend":"descend"]):v([a.key,"descend"])}},/*#__PURE__*/_react["default"].createElement("span",{style:_objectSpread({},a.center?{width:"100%",textAlign:"center"}:{})},a.title),/*#__PURE__*/_react["default"].createElement(_Sort["default"],{direction:u&&u[0]===a.key?u[1]:null}))})),/*#__PURE__*/_react["default"].createElement("div",{className:"ezr-rows"},/*#__PURE__*/_react["default"].createElement(_simplebarReact["default"],{style:{height:"".concat(e,"px")}},function(a){var b=a.scrollableNodeRef,f=a.contentNodeRef;return/*#__PURE__*/_react["default"].createElement(_StyledList["default"],{innerRef:f,outerRef:b,height:e,width:"100%",onItemsRendered:function onItemsRendered(a){var b=a.overscanStartIndex,c=a.overscanStopIndex,d=a.visibleStartIndex,e=a.visibleStopIndex;e===r.length-1&&!y&&g&&""===q.value&&(g(e),z(!0))},itemCount:A.length,itemSize:d},function(a){var b=a.index,d=a.style,e=A[b];return/*#__PURE__*/_react["default"].createElement("div",{style:_objectSpread({},d),key:n?e.__proto__[n]:b,className:"ezr-row"},m&&/*#__PURE__*/_react["default"].createElement(_Checkbox["default"],{checked:D.find(function(a){return a[n]===e.__proto__[n]}),onChecked:function onChecked(){return K(e.__proto__)},onUnchecked:function onUnchecked(){return M(e.__proto__)},accentColor:i}),Object.keys(e).map(function(a,b){var d,f=null!==(d=c[b])&&void 0!==d&&d.center?"center":"initial";return/*#__PURE__*/_react["default"].createElement(_RowCell["default"],{key:b,style:{textAlign:f,width:"".concat(c[b].width,"px")},value:e[a]})}))})}))),/*#__PURE__*/_react["default"].createElement("div",{className:"ezr-footer"},/*#__PURE__*/_react["default"].createElement("span",null,A.length),/*#__PURE__*/_react["default"].createElement("span",null,"items"))))};EzReactTable.defaultProps={cols:[],data:[],rowHeight:50,tableHeight:300,update:null,infiniteLoad:null,defaultSort:null,accentColor:"#b8b8b8",darkMode:!1,title:null,toolbar:[],selectable:!1,uid:null},EzReactTable.propTypes={cols:_propTypes["default"].array,data:_propTypes["default"].array,rowHeight:_propTypes["default"].number,tableHeight:_propTypes["default"].number,update:_propTypes["default"].func,infiniteLoad:_propTypes["default"].func,defaultSort:_propTypes["default"].string,accentColor:_propTypes["default"].string,darkMode:_propTypes["default"].bool,title:_propTypes["default"].oneOfType([_propTypes["default"].string,_propTypes["default"].func]),toolbar:_propTypes["default"].array,selectable:_propTypes["default"].bool,uid:_propTypes["default"].string};var _default=EzReactTable;exports["default"]=_default;